#!/bin/sh

# Name:
#   sh_put_s1
#   

# Purpose:
#   

# Example:
#   

# Modifications:
#   

# Algorigthm:
#   

# Dependency:
#   


if [ "$esa_data" = "" ]; then
    echo "ESA environment esa_data variable not set! Stopped!!"
    exit 1
fi

if [ "$1" == "" -o "$2" == "" ]; then
    echo "Usage: sh_esa_s1_link_slc file opath"
    exit
fi
file=$1
oldpath=`pwd`
cd $2
if [ $? -ne 0 ]; then
    echo "ERROR: output directory not accessiable! Stopped!"
    exit 1
fi
opath=`pwd`
cd $oldpath


grep '^ ' $file | awk '{print $1}' > .tmp
#echo a > .tmp
while read line; do
    echo $line
    file=/g4d/esa.data/S1/`basename ${line} | awk -F. '{print $1".zip"}'`
    if [ ! -e $file ]; then
	echo ERROR $file not exist
	continue
    fi
    if [ -s ${opath}/${dfile} ]; then
	echo "WARNING:data already linked [${opath}/${dfile}]! Skipped!"
	file ${opath}/${dfile}
        continue
	#exit 1
    fi
    #echo ncftpput -u luoyi -p icd123456 10.4.28.67 /cloud1/ESA/S1/lys/ $line
    #echo ncftpput -u luoyi -p icd123456 10.4.28.67 /cloud1/ESA/S1/lys/ $line 
    #echo scp $file  vmshare:/cloud1/ESA/S1/lys/
    #echo scp $file  vmshare:/cloud1/ESA/S1/lys/ | sh
    echo ln -s $file ${opath}/
    echo ln -s $file ${opath}/ | sh
done < .tmp
